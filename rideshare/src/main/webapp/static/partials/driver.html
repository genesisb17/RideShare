<!-- Button trigger modal -->
<div class="btn-container">
	<button type="button" class="btn btn-primary btn-lg" data-toggle="modal"
		data-target="#myModal">Make offer</button>
</div>


<!-- Tabs that display active rides and ride history for a user -->
<div>

	<!-- Nav tabs -->
	<ul class="nav nav-tabs" role="tablist">
		<li role="presentation" class="active"><a href="#open"
			aria-controls="open" role="tab" data-toggle="tab" target="_self">Available</a></li>
		<li role="presentation"><a href="#active" aria-controls="active"
			role="tab" data-toggle="tab" target="_self">In Progress</a></li>
		<li role="presentation"><a href="#history"
			aria-controls="history" role="tab" data-toggle="tab" target="_self">History</a></li>
	</ul>

	<!-- Tab panes -->
	<div class="tab-content">

		<div role="tabpanel" class="tab-pane active" id="open">

			<!-- Select location to filter available rides -->
			<div class="input-group location-selector">
				<span class="input-group-addon">Location</span>
				<select class="form-control" ng-model="selectedItem"
					ng-options="poi.poiName for poi in allPoi" ng-change="updateSort(selectedItem)"></select>
			</div>

			<!-- html and angular function used to display open rides -->
			<ul class="tabbed-list">

				<li ng-if="openRequest.length == 0">No open requests for this
					point of interest</li>

				<li ng-repeat="req in openRequest">
					<div data-toggle="collapse" data-target="#req{{req.requestId}}">
					{{req.user.fullName}} <em>@</em> {{req.time | date: 'h:mm a MMM dd'}}<br/>
					{{req.pickupLocation.poiName}}
					<span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
					{{req.dropOffLocation.poiName}}
					<!-- Beginning of expanded portion -->
					<div id="req{{req.requestId}}" class="collapse">
					<br/><br/>
 <!-- 				{{req.pickupLocation.addressLine1}}
					{{req.dropOffLocation.addressLine1}}
 -->
					Note: <i>{{req.notes}} <span ng-show=" req.notes == null"> N/A </span></i>

					<div class="btn-container">
						<button type="button" class="btn btn-primary"
							ng-click="acceptReq(req.requestId)">Accept Request</button>
					</div>
					</div>
					</div>
					<!-- End of expanded portion -->
				</li>

			</ul>

		</div>

		<div role="tabpanel" class="tab-pane" id="active">

			<!-- html and angular function used to display open rides -->
			<ul class="tabbed-list">

				<li ng-if="activeRides.length == 0">No active rides</li>

				<li ng-repeat="ride in activeRides">
					<div data-toggle="collapse" data-target="#active{{ride.availRide.availRideId}}">
						<em>@</em> {{ride.availRide.time | date: 'h:mm a MMM dd'}}
						<br/>

						{{ride.availRide.pickupPOI.poiName}}
						<span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
						{{ride.availRide.dropoffPOI.poiName}}
					

					<div id="active{{ride.availRide.availRideId}}" class="collapse">
						<br/>
<!-- 					Car: {{ride.availRide.car.color}} {{ride.availRide.car.model}}
						<br/>
 -->
						<div ng-show="isArray(ride.request)">
							<em>Passengers:</em>
							<ul class="passenger-list">
								<li ng-repeat="request in ride.request">
									{{request.user.fullName}}
									<span ng-show="request.notes != null"> ( <i>{{request.notes}}</i> )</span>
								</li>
							</ul>
						</div>

						<div class="btn-container">
							<button type="submit" class="btn btn-primary"
								ng-click="offerCancel(ride.availRide.availRideId)">Cancel
								Offer</button>
						</div>
					</div>
					</div>
				</li>
			</ul>

		</div>

		<div role="tabpanel" class="tab-pane" id="history">
			
			
			<ul class="tabbed-list">

				<li ng-if="activeRides.length == 0">No active rides</li>

				<li ng-repeat="ride in pastRides">
					<div data-toggle="collapse" data-target="#past{{ride.availRide.availRideId}}">
						<em>@</em> {{ride.availRide.time | date: 'h:mm a MMM dd'}}
						<br/>

						{{ride.availRide.pickupPOI.poiName}}
						<span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
						{{ride.availRide.dropoffPOI.poiName}}
					

					<div id="past{{ride.availRide.availRideId}}" class="collapse">
						<br/>
<!-- 					Car: {{ride.availRide.car.color}} {{ride.availRide.car.model}}
						<br/>
 -->
						<div ng-show="isArray(ride.request)">
							<em>Passengers:</em>
							<ul class="passenger-list">
								<li ng-repeat="request in ride.request">
									{{request.user.fullName}}
									<span ng-show="request.notes != null"> ( <i>{{request.notes}}</i> )</span>
								</li>
							</ul>
						</div>
						<br/>
						Complaint: <i>{{ride.complaint}} <span ng-show=" ride.complaint == null"> N/A </span></i>
					</div>
					</div>
				</li>
			</ul>
		</div>
	</div>
</div>


<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
	aria-labelledby="myModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">Offer a Ride</h4>
			</div>
			<div class="modal-body">

				<form>
					<table class="table">
						<tr>
							<td>
								<select class="form-control" ng-model="pickup"
									ng-options="poi.poiName for poi in allPoi" required="required">
									<option value="" disabled selected>Starting point</option>
								</select>
							</td>
						</tr>

						<tr>
							<td>
								<select class="form-control" ng-model="dropoff"
									ng-options="poi.poiName for poi in allPoi" required="required">
									<option value="" disabled selected>Destination</option>
								</select>
							</td>
						</tr>
						<tr>
							<td>
								<input class="form-control" type="text" ng-model="notes" placeholder="Notes" />
							</td>
						</tr>
						<tr>
							<td>
								<input class="form-control" type="number" ng-model="seats"
									placeholder="Avalible seats" />
							</td>
						</tr>
						<tr>
							<td>
								<input class="form-control" type="datetime-local" ng-model="time" placeholder="Time" />
							</td>
						</tr>

					</table>
				</form>

			</div>
			<div class="modal-footer">
				<button type="submit" class="btn btn-primary"
					ng-click="addOffer(pickup,dropoff,notes,time,seats)"
					data-dismiss="modal">Submit</button>
			</div>
		</div>
	</div>
</div>
